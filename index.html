<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Blood Donation</title>
    <!-- tailwind css link  -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- css file link  -->
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- Nav start-->
      <div class="navbar"></div>
    <!-- Nav end-->

    <!-- Hero section start  -->
    <section
      class="relative w-full bg-gradient-to-r from-red-800 via-red-800 to-red-800 overflow-hidden pt-20 sm:pt-16"
    >
      <!-- Background image -->
      <div class="absolute inset-0">
        <img
          src="https://static.vecteezy.com/system/resources/previews/008/191/708/non_2x/human-blood-donate-and-heart-rate-on-white-background-free-vector.jpg"
          alt="Blood Donation"
          class="w-full h-full object-cover opacity-30"
        />
        <div
          class="absolute inset-0 bg-gradient-to-r from-red-800 via-red-800 to-red-800 opacity-70"
        ></div>
      </div>

      <!-- Content -->
      <div
        class="relative max-w-7xl mx-auto px-6 sm:px-8 lg:px-12 flex flex-col justify-center items-start h-screen text-white"
      >
        <!-- Hero animated headline -->
        <h1
          class="text-[25px] sm:text-5xl lg:text-6xl font-extrabold leading-tight drop-shadow-lg"
        >
          <span class="clip-text">Give Blood, Save Life</span>
        </h1>

        <!-- Subtext -->
        <p class="mt-4 text- sm:text-xl lg:text-2xl max-w-2xl drop-shadow-md">
          Join our nationwide blood donation network and help those in need.
          Your one donation can save multiple lives.
        </p>

        <!-- CTA Buttons -->
        <div class="mt-8 flex flex-row justify-start gap-4 flex-wrap">
          <!-- Donate Button -->
          <a
            href="#donate"
            class="px-6 py-3 rounded-full font-semibold text-white shadow-lg bg-gradient-to-r from-pink-500 to-red-600 text-center transition-transform duration-300 transform hover:scale-105 hover:shadow-xl"
          >
            Donate Blood
          </a>

          <!-- Request Button -->
          <a
            href="#request"
            class="px-6 py-3 rounded-full font-bold text-red-900 shadow-lg bg-gradient-to-r from-yellow-400 via-amber-400 to-orange-400 text-center transition-transform duration-300 transform hover:scale-105 hover:shadow-xl"
          >
            Request Blood
          </a>
        </div>
        <!-- Decorative Glass Card -->
        <div
          class="mt-12 w-full max-w-md p-6 bg-white/10 backdrop-blur-xl rounded-xl shadow-2xl border border-white/20"
        >
          <p class="text-white text-lg font-medium text-center">
            Be a Hero Today! Register as a donor and make a difference.
          </p>
        </div>
      </div>
    </section>
    <!-- Hero section end  -->

<!-- login modal start  -->
<!-- Registration Modal -->
<div class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4" id="registerModal">
  <div class="relative bg-white/95 backdrop-blur-xl border border-gray-200 rounded-3xl shadow-2xl w-full max-w-md p-8 transform scale-95 opacity-0 transition-all duration-300 max-h-[90vh] overflow-y-auto no-scrollbar">
    
    <!-- Close Button -->
    <button onclick="closeModal('registerModal')" class="absolute top-4 right-4 text-gray-400 hover:text-pink-500 text-xl">✖</button>

    <!-- Title -->
    <h2 class="text-3xl font-extrabold text-center text-gray-900">Create Account</h2>
    <p class="text-center text-gray-500 mt-1">Register & verify your NID and Phone</p>

    <!-- Form -->
    <form id="registerForm" class="mt-6 space-y-4">
      <input type="text" placeholder="Full Name" required class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-pink-500 outline-none shadow-sm">
      <input type="email" placeholder="Email Address" required class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-pink-500 outline-none shadow-sm">
      <input type="tel" id="phone" placeholder="Phone Number (+880...)" required class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-pink-500 outline-none shadow-sm">
      <input type="text" id="otpInput" placeholder="Enter OTP" class="w-full px-4 py-3 border rounded-xl hidden" maxlength="6">
      <button type="button" id="verifyBtn" class="w-full bg-gradient-to-r from-red-600 to-pink-600 text-white py-3 rounded-xl shadow hidden hover:scale-105 transition transform" onclick="verifyOTP()">Verify OTP</button>
      
      <!-- Password -->
      <input type="password" placeholder="Password" required class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-pink-500 outline-none shadow-sm">

      <!-- NID -->
      <input type="text" id="nidNumber" placeholder="NID Number (auto)" readonly class="w-full px-4 py-3 border rounded-xl bg-gray-100 outline-none shadow-sm">

      <button type="submit" class="w-full bg-pink-600 text-white py-3 rounded-xl shadow hover:scale-105 transition transform mt-2">Register</button>
    </form>

    <!-- Camera -->
    <div class="mt-6 flex flex-col items-center space-y-3">
      <video id="camera" autoplay class="w-full h-48 sm:h-56 border rounded-lg shadow"></video>
      <canvas id="snapshot" class="hidden"></canvas>
      <button type="button" onclick="captureNID()" class="px-6 py-2 bg-pink-600 text-white rounded-xl shadow hover:scale-105 transition transform">Capture NID</button>
      <img id="capturedImage" class="w-full rounded-lg shadow hidden"/>
      <p class="text-sm text-gray-500 text-center mt-2">Ensure your NID is clear and readable</p>
    </div>

    <!-- Switch -->
    <p class="mt-6 text-sm text-gray-600 text-center">
      Already have an account?
      <button onclick="switchToLogin()" class="text-pink-600 font-semibold hover:underline">Login</button>
    </p>
  </div>
</div>

<!-- Login Modal -->
<div class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4" id="loginModal">
  <div class="relative bg-white/95 backdrop-blur-xl border border-gray-200 rounded-3xl shadow-2xl w-full max-w-md p-8 transform scale-95 opacity-0 transition-all duration-300">
    
    <button onclick="closeModal('loginModal')" class="absolute top-4 right-4 text-gray-400 hover:text-pink-500 text-xl">✖</button>

    <h2 class="text-3xl font-extrabold text-center text-gray-900">Login</h2>
    <p class="text-center text-gray-500 mt-1">Access your account</p>

    <form class="mt-6 space-y-4">
      <input type="email" placeholder="Email Address or phone number" required class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-pink-500 outline-none shadow-sm">
      <input type="password" placeholder="Password" required class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-pink-500 outline-none shadow-sm">
      <button type="submit" class="w-full bg-pink-600 text-white py-3 rounded-xl shadow hover:scale-105 transition transform">Login</button>
    </form>

    <p class="mt-6 text-sm text-gray-600 text-center">
      Don't have an account?
      <button onclick="switchToRegister()" class="text-pink-600 font-semibold hover:underline">Register</button>
    </p>
  </div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.1.1/dist/tesseract.min.js"></script>
<script>
let generatedOTP = null;
let otpVerified = false;
const video = document.getElementById('camera');
const canvas = document.getElementById('snapshot');
const capturedImage = document.getElementById('capturedImage');
const nidNumberInput = document.getElementById('nidNumber');

function openModal(id) {
  const modal = document.getElementById(id);
  const box = modal.querySelector("div");
  modal.classList.remove("hidden");
  setTimeout(() => {
    box.classList.remove("scale-95","opacity-0");
    box.classList.add("scale-100","opacity-100");
  }, 10);
  if(id==='registerModal'){
    navigator.mediaDevices.getUserMedia({video:true})
      .then(stream=>video.srcObject=stream)
      .catch(err=>alert("Camera not accessible: "+err));
  }
}

function closeModal(id){
  const modal=document.getElementById(id);
  const box=modal.querySelector("div");
  box.classList.remove("scale-100","opacity-100");
  box.classList.add("scale-95","opacity-0");
  setTimeout(()=>{
    modal.classList.add("hidden");
    if(id==='registerModal' && video.srcObject) video.srcObject.getTracks().forEach(t=>t.stop());
  },200);
}

function switchToLogin(){closeModal('registerModal'); setTimeout(()=>openModal('loginModal'),250);}
function switchToRegister(){closeModal('loginModal'); setTimeout(()=>openModal('registerModal'),250);}

// OTP
function sendOTP(){
  const phone=document.getElementById('phone').value;
  const phoneRegex=/^\+8801[0-9]{8}$/;
  if(!phoneRegex.test(phone)){alert("❌ Enter valid Bangladeshi phone number"); return;}
  generatedOTP=Math.floor(100000+Math.random()*900000);
  console.log("Generated OTP:",generatedOTP);
  alert("✅ OTP sent (demo). Check console.");
  document.getElementById('otpInput').classList.remove('hidden');
  document.getElementById('verifyBtn').classList.remove('hidden');
}

function verifyOTP(){
  const entered=document.getElementById('otpInput').value;
  if(entered==generatedOTP){otpVerified=true; alert("✅ OTP verified"); document.getElementById('otpInput').classList.add('hidden'); document.getElementById('verifyBtn').classList.add('hidden');}
  else alert("❌ Invalid OTP");
}

// Capture NID + OCR
function captureNID(){
  const ctx=canvas.getContext('2d');
  canvas.width=video.videoWidth; canvas.height=video.videoHeight;
  ctx.drawImage(video,0,0,canvas.width,canvas.height);
  const imageData=canvas.toDataURL('image/png');
  capturedImage.src=imageData; capturedImage.classList.remove('hidden');
  alert("✅ NID captured. Running OCR...");
  Tesseract.recognize(imageData,'eng',{logger:m=>console.log(m)})
    .then(({data:{text}})=>{
      const nid=text.replace(/\D/g,'').slice(0,17);
      nidNumberInput.value=nid||"";
      if(nid) alert("✅ NID detected: "+nid);
      else alert("⚠ Could not detect NID");
    });
}

// Registration submit
document.getElementById('registerForm').addEventListener('submit',function(e){
  if(!otpVerified){e.preventDefault(); alert("❌ Verify phone first");}
  else if(!nidNumberInput.value){e.preventDefault(); alert("❌ Capture NID first");}
  else{alert("✅ Registration ready!");}
});
</script>

<!-- bcryptjs CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bcryptjs/2.4.3/bcrypt.min.js"></script>

<!-- login modal end -->
    <!-- js file link  -->
    <script src="app.js"></script>
    <script src="includes/nav.js"></script>
  </body>
</html>
